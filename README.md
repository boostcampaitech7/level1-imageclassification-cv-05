# Sketch ì´ë¯¸ì§€ ë°ì´í„° ë¶„ë¥˜

## ğŸ¥‡ íŒ€ êµ¬ì„±ì›
<div align="center">
<table>
  <tr>
    <td align="center">
      <a href="https://github.com/kimsuckhyun">
        <img src="https://stages.ai/_next/image?url=https%3A%2F%2Faistages-api-public-prod.s3.amazonaws.com%2Fapp%2FUsers%2F00004010%2Fuser_image.png&w=1920&q=75" width="120px" height="120px" alt=""/>
        <hr />
        <sub><b>ê¹€ì„í˜„</b></sub><br />
      </a>
    </td>
    <td align="center">
      <a href="https://github.com/kupulau">
        <img src="https://stages.ai/_next/image?url=https%3A%2F%2Faistages-api-public-prod.s3.amazonaws.com%2Fapp%2FUsers%2F00003808%2Fuser_image.png&w=1920&q=75" width="120px" height="120px" alt=""/>
        <hr />
        <sub><b>í™©ì§€ì€</b></sub><br />
      </a>
    </td>
    <td align="center">
      <a href="https://github.com/lexxsh">
        <img src="https://stages.ai/_next/image?url=https%3A%2F%2Faistages-api-public-prod.s3.amazonaws.com%2Fapp%2FUsers%2F00003955%2Fuser_image.png&w=1920&q=75" width="120px" height="120px" alt=""/>
        <hr />
        <sub><b>ì´ìƒí˜</b></sub><br />
      </a>
    </td>
    <td align="center">
      <a href="https://github.com/june21a">
        <img src="https://stages.ai/_next/image?url=https%3A%2F%2Faistages-api-public-prod.s3.amazonaws.com%2Fapp%2FUsers%2F00003793%2Fuser_image.png&w=1920&q=75" width="120px" height="120px" alt=""/>
        <hr />
        <sub><b>ë°•ì¤€ì¼</b></sub><br />
      </a>
    </td>
    <td align="center">
      <a href="https://github.com/glasshong">
        <img src="https://stages.ai/_next/image?url=https%3A%2F%2Faistages-api-public-prod.s3.amazonaws.com%2Fapp%2FUsers%2F00004034%2Fuser_image.png&w=1920&q=75" width="120px" height="120px" alt=""/>
        <hr />
        <sub><b>í™ìœ ë¦¬</b></sub><br />
      </a>
    </td>
  </tr>
</table>
</div>

<br />

## ğŸ—’ï¸ í”„ë¡œì íŠ¸ ê°œìš”
Sketchì´ë¯¸ì§€ ë¶„ë¥˜ ê²½ì§„ëŒ€íšŒëŠ” ì£¼ì–´ì§„ ë°ì´í„°ë¥¼ í™œìš©í•˜ì—¬ ëª¨ë¸ì„ ì œì‘í•˜ê³  ì–´ë–¤ ê°ì²´ë¥¼ ë‚˜íƒ€ë‚´ëŠ”ì§€ ë¶„ë¥˜í•˜ëŠ” ëŒ€íšŒì…ë‹ˆë‹¤.

Computer Visionì—ì„œëŠ” ë‹¤ì–‘í•œ í˜•íƒœì˜ ì´ë¯¸ì§€ ë°ì´í„°ê°€ í™œìš©ë˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ ì¤‘, ë¹„ì •í˜• ë°ì´í„°ì˜ ì •í™•í•œ ì¸ì‹ê³¼ ë¶„ë¥˜ëŠ” ì—¬ì „íˆ í•´ê²°í•´ì•¼ í•  ì£¼ìš” ê³¼ì œë¡œ ìë¦¬ì¡ê³  ìˆìŠµë‹ˆë‹¤. íŠ¹íˆ ì‚¬ì§„ê³¼ ê°™ì€ ì¼ë°˜ ì´ë¯¸ì§€ ë°ì´í„°ì— ê¸°ë°˜í•˜ì—¬ ë°œì „ì„ ì´ë£¨ì–´ë‚˜ì•„ê°€ê³  ìˆìŠµë‹ˆë‹¤.

í•˜ì§€ë§Œ ì¼ìƒì˜ ì‚¬ì§„ê³¼ ë‹¤ë¥´ê²Œ ìŠ¤ì¼€ì¹˜ëŠ” ì¸ê°„ì˜ ìƒìƒë ¥ê³¼ ê°œë… ì´í•´ë¥¼ ë°˜ì˜í•˜ëŠ” ì¶”ìƒì ì´ê³  ë‹¨ìˆœí™”ëœ í˜•íƒœì˜ ì´ë¯¸ì§€ì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ìŠ¤ì¼€ì¹˜ ë°ì´í„°ëŠ” ìƒ‰ìƒ, ì§ˆê°, ì„¸ë¶€ì ì¸ í˜•íƒœê°€ ë¹„êµì  ê²°ì—¬ë˜ì–´ ìˆìœ¼ë©°, ëŒ€ì‹ ì— ê¸°ë³¸ì ì¸ í˜•íƒœì™€ êµ¬ì¡°ì— ì´ˆì ì„ ë§ì¶¥ë‹ˆë‹¤. ì´ëŠ” ìŠ¤ì¼€ì¹˜ê°€ ì‹¤ì œ ê°ì²´ì˜ ë³¸ì§ˆì  íŠ¹ì§•ì„ ê°„ê²°í•˜ê²Œ í‘œí˜„í•˜ëŠ”ë°ì— ì¤‘ì ì„ ë‘ê³  ìˆë‹¤ëŠ” ì ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.

ì´ëŸ¬í•œ ìŠ¤ì¼€ì¹˜ ë°ì´í„°ì˜ íŠ¹ì„±ì„ ì´í•´í•˜ê³  ìŠ¤ì¼€ì¹˜ ì´ë¯¸ì§€ë¥¼ í†µí•´ ëª¨ë¸ì´ ê°ì²´ì˜ ê¸°ë³¸ì ì¸ í˜•íƒœì™€ êµ¬ì¡°ë¥¼ í•™ìŠµí•˜ê³  ì¸ì‹í•˜ë„ë¡ í•¨ìœ¼ë¡œì¨, ì¼ë°˜ì ì¸ ì´ë¯¸ì§€ ë°ì´í„°ì™€ì˜ ì°¨ì´ì ì„ ì´í•´í•˜ê³  ë˜ ë‹¤ë¥¸ ê´€ì ì— ëŒ€í•œ ëª¨ë¸ ê°œë°œ ì—­ëŸ‰ì„ ë†’ì´ëŠ”ë°ì— ì´ˆì ì„ ë‘ì—ˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì‹¤ì œ ì„¸ê³„ì˜ ë³µì¡í•˜ê³  ë‹¤ì–‘í•œ ì´ë¯¸ì§€ ë°ì´í„°ì— ëŒ€í•œ ì°½ì˜ì ì¸ ì ‘ê·¼ë°©ë²•ê³¼ ì²˜ë¦¬ ëŠ¥ë ¥ì„ ë†’ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ, ìŠ¤ì¼€ì¹˜ ë°ì´í„°ë¥¼ í™œìš©í•˜ëŠ” ì¸ê³µì§€ëŠ¥ ëª¨ë¸ì€ ë””ì§€í„¸ ì˜ˆìˆ , ê²Œì„ ê°œë°œ, êµìœ¡ ì½˜í…ì¸  ìƒì„± ë“± ë‹¤ì–‘í•œ ë¶„ì•¼ì—ì„œ ì‘ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
<br />

## ğŸ“… í”„ë¡œì íŠ¸ ì¼ì •
í”„ë¡œì íŠ¸ ì „ì²´ ì¼ì •

- 2024.09.10 (í™”) 10:00 ~ 2024.09.26 (ëª©) 17:00

í”„ë¡œì íŠ¸ ì„¸ë¶€ ì¼ì • 


## ğŸ’» ê°œë°œ í™˜ê²½
```bash
- Language : Python
- Environment
  - CPU : Intel(R) Xeon(R) Gold 5120
  - GPU : Tesla V100-SXM2 32GB Ã— 1
- Framework : PyTorch
- Collaborative Tool : Git, Wandb, Notion
```


## ğŸ† í”„ë¡œì íŠ¸ ê²°ê³¼ (ìˆ˜ì •)
- Private ë¦¬ë”ë³´ë“œì—ì„œ ìµœì¢…ì ìœ¼ë¡œ ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ë¥¼ ì–»ì—ˆìŠµë‹ˆë‹¤.  


## ğŸ“ ë°ì´í„°ì…‹ êµ¬ì¡° 

```
ğŸ“¦data
 â”£ ğŸ“œsample_submission.csv
 â”£ ğŸ“œtest.csv
 â”£ ğŸ“œtrain.csv
 â”£ ğŸ“‚test
 â”ƒ â”£ ğŸ“œ0.JPEG
 â”ƒ â”£ ğŸ“œ1.JPEG
 â”ƒ â”£ ğŸ“œ2.JPEG
 â”ƒ â”— ...
 â”£ ğŸ“‚train
 â”ƒ â”£ ğŸ“‚n01443537
 â”ƒ â”£ ğŸ“‚n01484850
 â”ƒ â”— ...
```
- í•™ìŠµì— ì‚¬ìš©í•  ì´ë¯¸ì§€ ë°ì´í„°ëŠ” 15,021ê°œë¡œ data/train/ ì•„ë˜ì— ê° ê°ì²´ë³„ í´ë”ë¡œ êµ¬ë¶„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. 
- ì œê³µë˜ëŠ” ì´ë¯¸ì§€ëŠ” ì£¼ë¡œ ì‚¬ëŒì˜ ì†ìœ¼ë¡œ ê·¸ë ¤ì§„ ë“œë¡œì‰ì´ë‚˜ ìŠ¤ì¼€ì¹˜ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤. 
- train.csvì™€ test.csvì—ëŠ” ê° ì´ë¯¸ì§€ë³„ í´ë”ëª…(class_name), ì´ë¯¸ì§€ ê²½ë¡œ(image_path), ì˜ˆì¸¡í•´ì•¼í•  class(target)ì— ëŒ€í•œ ì •ë³´ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

<br />

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡° 
```
ğŸ“¦level1-imageclassification-cv-05-main
 â”£ ğŸ“‚.github
 â”ƒ â”— ğŸ“œ.keep
 â”£ ğŸ“‚baseline_code
 â”ƒ â”£ ğŸ“œbaseline_code.ipynb
 â”ƒ â”— ğŸ“œeda.ipynb
 â”£ ğŸ“‚config
 â”ƒ â”£ ğŸ“œtest_setting.yml
 â”ƒ â”£ ğŸ“œtest_transform
 â”ƒ â”£ ğŸ“œtest_transform.yml
 â”ƒ â”£ ğŸ“œtraining_setting.yml
 â”ƒ â”£ ğŸ“œtrain_transform.yml
 â”ƒ â”— ğŸ“œtransform.json
 â”£ ğŸ“‚dataloader
 â”ƒ â”£ ğŸ“œdataloader.py
 â”ƒ â”— ğŸ“œpreprocess.py
 â”£ ğŸ“‚model
 â”ƒ â”£ ğŸ“œ_loss.py
 â”ƒ â”£ ğŸ“œ_model.py
 â”ƒ â”£ ğŸ“œ_optimizer.py
 â”ƒ â”— ğŸ“œ_schedular.py
 â”£ ğŸ“‚util
 â”ƒ â”£ ğŸ“œseed.py
 â”ƒ â”£ ğŸ“œutility.py
 â”ƒ â”— ğŸ“œvisualize.py
 â”£ ğŸ“œ.gitignore
 â”£ ğŸ“œaugmentation_list.txt
 â”£ ğŸ“œinfer.py
 â”£ ğŸ“œREADME.md
 â”£ ğŸ“œrequirements.txt
 â”£ ğŸ“œtimm_list.txt
 â”— ğŸ“œtrain.py
```
### (ìˆ˜ì •)
#### 1) `dataloader/Preprocess.py` 
- resizeì™€ ì—¬ëŸ¬ augmentation classë¥¼ êµ¬í˜„í•œ íŒŒì¼
- 'config/training_setting.yml'ì—ì„œ augmentationì¸ìì˜ parameterê°’ ë³€ê²½ 
#### 2) `dataloader/dataloader.py` 
- ì •ì˜ëœ ì „ì²˜ë¦¬ ë°©ì‹ìœ¼ë¡œ  transformì„ ì ìš©í•œ í›„ imageì™€ targetì„ tupleë¡œ returní•˜ëŠ” íŒŒì¼
- torch Dataset ê°ì²´ë¥¼ return
#### 3) `model.py`
- í•™ìŠµì— ì‚¬ìš©í•œ Model í´ë˜ìŠ¤ë¥¼ êµ¬í˜„í•œ íŒŒì¼ 
- resnet34, resnet50, Resnet34CategoryModel, efficientnet_b0, efficientnet_b1, efficientnet_b2, efficientnet_b5, vit_base_patch16_224, vit_B_16_imagenet1k, vit-age-classifier
#### 4) `train.py`
- config ê°’ì„ í†µí•´ í•™ìŠµ íŒŒë¼ë¯¸í„°ë“¤ì„ ë¶ˆëŸ¬ì˜¤ê³  training í•¨ìˆ˜ì— ì „ë‹¬í•˜ëŠ” íŒŒì¼
- wandbë¥¼ í†µí•œ í•™ìŠµ ì§„í–‰ìƒí™© ë¡œê¹… êµ¬í˜„
#### 5) `function.py`
- ì…ë ¥ìœ¼ë¡œ ë“¤ì–´ì˜¨ íŒŒë¼ë¯¸í„°ë¥¼ í†µí•´ train ë°ì´í„°ì…‹ìœ¼ë¡œ ëª¨ë¸ í•™ìŠµì„ ì§„í–‰í•˜ëŠ” íŒŒì¼
- ì¡°ê±´ì— ë§ëŠ” í•™ìŠµ(k-fold, classë³„ í•™ìŠµ)ì„ ì§„í–‰ í›„ best ëª¨ë¸ì„ ì €ì¥
#### 6) `inference`
- `inference.py` : í•™ìŠµ ì™„ë£Œëœ ëª¨ë¸ì„ í†µí•´ eval setì— ëŒ€í•œ ì˜ˆì¸¡ ê°’ì„ êµ¬í•˜ê³  ì´ë¥¼ .csv í˜•ì‹ìœ¼ë¡œ ì €ì¥í•˜ëŠ” íŒŒì¼ 
- `k-fold-inference.py` : hard voting ë°©ì‹ìœ¼ë¡œ k-foldë¥¼ ì ìš©í•˜ì—¬ ì˜ˆì¸¡ê°’ì„ êµ¬í•˜ê³ , ì´ë¥¼ .csv í˜•ì‹ìœ¼ë¡œ ì €ì¥í•˜ëŠ” íŒŒì¼
#### 7) `ensemble_weights.py`
- ì—¬ëŸ¬ í•™ìŠµ ëª¨ë¸ë“¤ë¡œ ìƒì„±í•œ ê²°ê³¼ë“¤ì„ hard votingí•˜ì—¬ ì•™ìƒë¸”ëœ ê²°ê³¼ë¥¼ ì¶”ë¡ í•˜ëŠ” íŒŒì¼
- inference íŒŒì¼ì„ í†µí•´ ìƒì„±ëœ .csv íŒŒì¼ì„ ì…ë ¥ìœ¼ë¡œ ë°›ì•„ ìƒˆë¡œìš´ .csv íŒŒì¼ì„ ìƒì„± ë° ì €ì¥
#### 8) `redis_model_scheduler`
- `redis_publisher.py` : redis queueì— ì›í•˜ëŠ” í•™ìŠµ config ê°’ì„ ì „ë‹¬í•˜ëŠ” íŒŒì¼
- `schedlue_search.py` : redis queueì—ì„œ í•™ìŠµì„ ê¸°ë‹¤ë¦¬ê³  ìˆëŠ” config ê°’ì„ ì¡°íšŒ ë° ì‚­ì œí•˜ëŠ” ê¸°ëŠ¥ êµ¬í˜„
- `task_consumer.py` : redis queueì— ê°’ì´ ë“¤ì–´ì˜¤ë©´ ìˆœì°¨ì ìœ¼ë¡œ configë¥¼ ì…ë ¥ë°›ì•„ trainì— ì „ë‹¬

<br />

## âš™ï¸ requirements

- black==23.9.1
- matplotlib==3.8.2
- numpy==1.26.0
- pandas==2.1.4
- Pillow==9.4.0
- python-dotenv==1.0.0
- scikit-learn==1.2.2
- tensorboard==2.15.1
- torch==2.1.0
- torchvision==0.16.0
- timm==0.9.12
- transformers==4.36.2
- pytorch-pretrained-vit==0.0.7
- wandb==0.16.1
- redis==5.0.1
- GitPython==3.1.40
- imgaug==0.4.0
- efficientnet-pytorch ==0.7.1

`pip3 install -r requirements.txt`

<br />

## â–¶ï¸ ì‹¤í–‰ ë°©ë²•

#### Train
`python train.py`

#### Inferecne
`python inference.py --model_dir [ëª¨ë¸ì €ì¥ê²½ë¡œ]`

#### schedulerë¥¼ í†µí•œ ì‹¤í–‰
`python ./redis_model_scheduler/redis_publisher.py --ip [ipì£¼ì†Œ] --port [portë²ˆí˜¸] --user [ì´ë¦„]`  

`python ./redis_model_scheduler/task_consumer.py --ip [ipì£¼ì†Œ] --port [portë²ˆí˜¸] --mode [modeì´ë¦„]`


<br />

## âœï¸ Wrap-Up Report   
- [Wrap-Up Report](https://github.com/boostcampaitech6/level1-imageclassification-cv-02/blob/main/docs/CV%EA%B8%B0%EC%B4%88%EB%8C%80%ED%9A%8C_CV_2%ED%8C%80%20%EB%A6%AC%ED%8F%AC%ED%8A%B8(02%EC%A1%B0)_%EC%97%85%EB%A1%9C%EB%93%9C%EC%9A%A9.pdf)
